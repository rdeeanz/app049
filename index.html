<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Orb Catcher | Gesture-Controlled 3D Game</title>
    <meta name="description" content="A stunning 3D arcade game controlled by hand gestures using Babylon.js and MediaPipe">
    
    <!-- Babylon.js 6.x (pinned) -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    
    <!-- MediaPipe Hands (pinned versions) -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3.1675466862/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1675469240/hands.js" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Game Canvas -->
    <canvas id="renderCanvas"></canvas>
    
    <!-- Hidden Video Element for CV Processing -->
    <video id="cameraFeed" playsinline style="display: none;"></video>
    
    <!-- Camera Preview (toggleable) -->
    <div id="cameraPreview" class="camera-preview hidden">
        <video id="previewVideo" playsinline muted></video>
        <canvas id="handCanvas"></canvas>
        <button id="togglePreview" class="toggle-btn">üì∑</button>
    </div>
    
    <!-- HUD Overlay -->
    <div id="hud" class="hud hidden">
        <div class="hud-item score-container">
            <span class="label">SCORE</span>
            <span id="score" class="value">0</span>
        </div>
        <div class="hud-item combo-container">
            <span class="label">COMBO</span>
            <span id="combo" class="value">x1</span>
        </div>
        <div class="hud-item shield-container">
            <span class="label">SHIELD</span>
            <div class="shield-bar">
                <div id="shieldFill" class="shield-fill"></div>
            </div>
        </div>
        <div id="inputIndicator" class="input-indicator">
            <span id="inputType">üé• Gesture</span>
        </div>
    </div>
    
    <!-- Menu Screen -->
    <div id="menuScreen" class="screen menu-screen">
        <div class="menu-content">
            <h1 class="game-title">COSMIC ORB CATCHER</h1>
            <p class="subtitle">Control with your hands or keyboard</p>
            
            <div class="instructions">
                <div class="instruction-item">
                    <span class="icon">‚úã</span>
                    <span>Move hand to control platform</span>
                </div>
                <div class="instruction-item">
                    <span class="icon">ü§è</span>
                    <span>Pinch to activate shield</span>
                </div>
                <div class="instruction-item">
                    <span class="icon">‚å®Ô∏è</span>
                    <span>WASD/Arrows + Space (fallback)</span>
                </div>
            </div>
            
            <button id="startBtn" class="btn primary-btn">
                <span class="btn-text">START GAME</span>
                <span class="btn-glow"></span>
            </button>
            
            <div id="permissionStatus" class="permission-status"></div>
        </div>
        
        <div class="floating-orbs">
            <div class="orb orb-1"></div>
            <div class="orb orb-2"></div>
            <div class="orb orb-3"></div>
        </div>
    </div>
    
    <!-- Game Over Screen -->
    <div id="gameOverScreen" class="screen game-over-screen hidden">
        <div class="game-over-content">
            <h2 class="game-over-title">GAME OVER</h2>
            <div class="final-stats">
                <div class="stat">
                    <span class="stat-label">Final Score</span>
                    <span id="finalScore" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Max Combo</span>
                    <span id="maxCombo" class="stat-value">x1</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Orbs Caught</span>
                    <span id="orbsCaught" class="stat-value">0</span>
                </div>
            </div>
            <button id="restartBtn" class="btn primary-btn">
                <span class="btn-text">PLAY AGAIN</span>
                <span class="btn-glow"></span>
            </button>
        </div>
    </div>
    
    <!-- Pause Overlay -->
    <div id="pauseOverlay" class="screen pause-overlay hidden">
        <div class="pause-content">
            <h2>PAUSED</h2>
            <p>Press ESC or P to resume</p>
        </div>
    </div>
    
    <!-- Notification Toast -->
    <div id="notification" class="notification hidden">
        <span id="notificationText"></span>
    </div>

    <!-- Module Scripts -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
